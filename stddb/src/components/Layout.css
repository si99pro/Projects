/* src/components/Layout.css */

/* --- Layout Wrapper --- */
.app-layout-wrapper {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  background-color: var(--color-bg-primary);
}

/* --- Main Grid Container (Desktop First - applies >= 900px by default) --- */
.main-grid-container {
  flex-grow: 1;
  display: grid;
  /* Columns: Left Sidebar | Main Content (Flexible) */
  /* Fixed right sidebar positioned independently */
  grid-template-columns: var(--sidebar-left-width) minmax(0, 1fr);
  gap: var(--layout-gap);
  /* Padding top is set dynamically by JS to account for header height + gap */
  /* Ensure JS adds appropriate space (e.g., headerHeight + layoutGap) */
  padding-bottom: var(--spacing-lg);
  padding-left: var(--layout-padding-x);
  /* Adjust right padding for fixed sidebar space */
  padding-right: calc(var(--sidebar-right-width) + var(--layout-gap) + var(--layout-padding-x));
  max-width: var(--layout-max-width);
  margin-left: auto; margin-right: auto;
  width: 100%;
  box-sizing: border-box;
  align-items: start;
}

/* --- Left Sidebar Wrapper (Sticky) --- */
.side-nav-wrapper {
  grid-column: 1 / 2;
  position: sticky;
  /* Stick relative to grid container's padding-top */
  top: 0;
   /* Adjust max-height based on header, gap, and grid bottom padding */
   /* Assuming grid padding-top accounts for header+gap */
  max-height: calc(100vh - var(--header-height) - var(--layout-gap) - var(--spacing-lg));
  overflow-y: auto;
  overflow-x: hidden;
  box-sizing: border-box;
}
/* .side-nav-wrapper::-webkit-scrollbar { display: none; } */


/* --- Main Content Area (Grid Cell) --- */
.main-content-area {
  grid-column: 2 / 3;
  min-width: 0;
  box-sizing: border-box;
  overflow: visible;
}

/* --- Inner Content Wrapper (Controls Max Width & Centering) --- */
.main-content-wrapper {
  max-width: var(--main-content-max-width);
  margin-left: auto;
  margin-right: auto;
  width: 100%;
  /* <<< MODIFIED: Removed top padding to align content with fixed sidebar top >>> */
  /* padding-top: var(--layout-padding-y); */ /* REMOVED */
  /* Keep bottom padding for space at the end of content */
  padding-bottom: var(--layout-padding-y);
  box-sizing: border-box;
}

/* --- Right Sidebar Wrapper (NOW FIXED) --- */
.right-sidebar-wrapper {
  position: fixed;
  /* Position below header + layout gap */
  top: calc(var(--header-height) + var(--layout-gap));
  /* Position from right edge, aligned with outer padding */
  right: var(--layout-padding-x);
  width: var(--sidebar-right-width);
  /* Height fills remaining viewport below top position */
  height: calc(100vh - var(--header-height) - var(--layout-gap));
  box-sizing: border-box;
  /* grid-column removed */
  overflow-y: auto;
  overflow-x: hidden;
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none; /* IE/Edge legacy */
}
/* For Chrome, Safari, and newer Edge (Webkit-based) */
.right-sidebar-wrapper::-webkit-scrollbar {
  display: none; /* Hide the scrollbar */
}


/* --- Responsive Adjustments --- */

/* Tablet - Hide right sidebar, main content takes remaining space */
@media (min-width: 900px) and (max-width: 1199.95px) {
    .main-grid-container {
        /* Two columns: Left Sidebar | Main Content */
        grid-template-columns: var(--sidebar-left-width) minmax(0, 1fr);
        /* Reset right padding */
        padding-right: var(--layout-padding-x);
    }
    .right-sidebar-wrapper { display: none; } /* Hide right sidebar */
}

/* Mobile - Stack layout, hide sidebars */
@media (max-width: 899.95px) {
  .main-grid-container {
    display: block;
    padding: 0 !important;
    max-width: none;
    width: 100%;
    gap: 0;
    height: auto;
    overflow: visible;
  }
  /* Reset left sidebar */
  .side-nav-wrapper {
      display: none; position: static; height: auto;
      max-height: none; width: auto;
  }
  /* Reset right sidebar */
  .right-sidebar-wrapper {
      display: none; position: static; width: auto;
      height: auto; max-height: none; top: auto;
      right: auto; overflow: visible;
  }
  /* Reset main content area */
  .main-content-area {
     width: 100%; min-width: auto; height: auto;
     overflow: visible; padding: 0;
  }
  /* Adjust main content wrapper for mobile */
  .main-content-wrapper {
     max-width: none; margin-left: 0; margin-right: 0;
     /* <<< MODIFIED: Add padding below header for mobile view >>> */
     /* Note: Removed explicit top padding earlier for desktop alignment, */
     /* so ensure mobile padding is handled here or via another mobile-specific rule */
     padding: var(--spacing-md);
     padding-top: calc(var(--header-height) + var(--spacing-md));
     /* Keep the removed padding-top: var(--layout-padding-y) from the base rule in mind */
  }
}

/* --- Body class for mobile nav --- */
body.mobile-nav-active {
   overflow: hidden;
}

/* Add rule for when mobile nav IS displayed */
@media (max-width: 899.95px) {
    .side-nav-wrapper.mobile-nav-open {
        display: block; position: fixed; left: 0;
        top: 0; width: var(--sidebar-left-width);
        height: 100vh; background-color: var(--color-bg-sidenav);
        z-index: 1000; overflow-y: auto; max-height: none;
    }
}